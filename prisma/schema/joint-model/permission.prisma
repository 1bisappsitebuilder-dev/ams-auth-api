enum Resource {
    organization
    user
    role
    app
    module
}

enum Action {
    create
    read
    update
    delete
}

type RolePermission {
    resource Resource
    actions  Action[]
}

//many to many relation between security scheme and role
model Permission {
    id              String           @id @default(auto()) @map("_id") @db.ObjectId
    accessPolicyId  String           @db.ObjectId
    roleId          String           @db.ObjectId
    createdAt       DateTime         @default(now())
    updatedAt       DateTime         @updatedAt
    rolePermissions RolePermission[] // Permissions assigned to THIS role in THIS scheme

    //relations
    role           Role         @relation(fields: [roleId], references: [id])
    securityScheme AccessPolicy @relation(fields: [accessPolicyId], references: [id])

    @@unique([accessPolicyId, roleId])
    @@index([accessPolicyId])
    @@index([roleId])
}
